package de.persosim.simulator.perso;

import java.io.StringReader;
import java.security.KeyPair;

import de.persosim.simulator.crypto.CryptoUtil;
import de.persosim.simulator.utils.HexString;

/**
 * @author slutters
 *
 */
public class Profile04 extends AbstractProfile {
	
	@Override
	public void setPersoDataContainer() {
		persoDataContainer = PersonalizationDataContainer.getDefaultContainer();
		persoDataContainer.setDg3PlainData("20340630");
		persoDataContainer.setDg4PlainData("---");
		persoDataContainer.setDg5PlainData("ĆOSIĆ");
		persoDataContainer.setDg8PlainData("199409  ");
		persoDataContainer.setDg9PlainData("PRIŠTINA");
		persoDataContainer.setDg10PlainData("D");
		persoDataContainer.setDg17StreetPlainData("F4 14-15");
		persoDataContainer.setDg17CityPlainData("MANNHEIM");
		persoDataContainer.setDg17CountryPlainData("D");
		persoDataContainer.setDg17ZipPlainData("68159");
		persoDataContainer.setDg18PlainData("02760802220000");
		persoDataContainer.setEfCardAccess("3181C13012060A04007F0007020204020202010202010D300D060804007F00070202020201023012060A04007F00070202030202020102020129301C060904007F000702020302300C060704007F0007010202010D020129303E060804007F000702020831323012060A04007F0007020203020202010202012D301C060904007F000702020302300C060704007F0007010202010D02012D302A060804007F0007020206161E687474703A2F2F6273692E62756E642E64652F6369662F6E70612E786D6C");
		persoDataContainer.setEfCardSecurity("308209DD06092A864886F70D010702A08209CE308209CA020103310F300D06096086480165030402020500308203D8060804007F0007030201A08203CA048203C6318203C23012060A04007F0007020204020202010202010D300D060804007F00070202020201023017060A04007F0007020205020330090201010201010101003019060904007F000702020502300C060704007F0007010202010D3017060A04007F0007020205020330090201010201020101FF3012060A04007F00070202030202020102020129301C060904007F000702020302300C060704007F0007010202010D0201293062060904007F0007020201023052300C060704007F0007010202010D0342000419D4B7447788B0E1993DB35500999627E739A4E5E35F02D8FB07D6122E76567F17758D7A3AA6943EF23E5E2909B3E8B31BFAA4544C2CBF1FB487F31FF239C8F80201293081A3060804007F00070202083181963012060A04007F0007020203020202010202012D301C060904007F000702020302300C060704007F0007010202010D02012D3062060904007F0007020201023052300C060704007F0007010202010D0342000472E84F60AD1D8F7431DF4F4E49EBCEC897D5FE39381267802A28233F8959F2C1A0459DB30BE8CDC5AB443A61C4FFBC79943C5F0D32ABBFD2E66D75663957606002012D302A060804007F0007020206161E687474703A2F2F6273692E62756E642E64652F6369662F6E70612E786D6C308201E6060804007F0007020207308201D8300B0609608648016503040204308201C73021020101041C2FF0247F59DD3C646E314F03ABB33EE91A586577EBDF48D3864EC34D3021020102041C37823963B71AF0BF5698D1FDC30DA2B7F9ECE57CFA4959BEE9D6D9943021020103041C5304B09FE96C45572D90ADAB5FDBDCE3900CB1EB1FD246233EF34D473021020104041CD79ACB50275F95004CC34875DDBA71F29452A1ED71F58BB8DCDA30FC3021020105041CFF1C4426C5E70770B3F5F1E35AF756500BD13C2F2C6F862BD78FF5333021020106041C712B8550E49A13C64DCED4457E9A0F5A85DC26CD6A321596723005D63021020107041C42A8FA36B60887ED022CD3B6ECC255220FBE8CB3F607E416601FCAA63021020108041C456C087A7EF057AE78434539CA120416783CBB5E9ABD44E61D1FBF673021020109041CC468F55BA5F151DDF8A3158DD8508CE2516E2491A4C9495688FF43AE302102010A041C1880A259CDB497C15A7FDD1C9AC9490D7DC0D18743378603D43D1D4F302102010D041C859FE631F5DA379D44239EB85FAFDF7D52FDBC88986B254045DCF82A3021020111041C6C45277CD2D466ACBC958E3153D35B98CE7CF4F32133FB355FB3C1B53021020112041CBB964F9E774451366975CFF79883B9919E9B51988082DA08F1E39440A082049D30820499308203FEA00302010202020550300A06082A8648CE3D0403043046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E79301E170D3234303630333038353334355A170D3335303130333233353935395A305C310B3009060355040613024445310C300A060355040A0C03425349310D300B06035504051304303133313130302E06035504030C275445535420446F63756D656E74205369676E6572204964656E7469747920446F63756D656E7473308201B53082014D06072A8648CE3D020130820140020101303C06072A8648CE3D01010231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53306404307BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826043004A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C110461041D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C53150231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E904656502010103620004301BB91C96792E65620452749E319C2B62C46B8EBBE846438F098DE4416ECF63463C5518B961482D12FCDFEE2AC349C58B752A893FE94D6E87445976C6309635399E20ED50B5520D501F52835E58AEA0C2A57CC6CFBC7F806228C58F18B0630DA382016630820162301F0603551D23041830168014E4F934EE5ED98D61C3F2EF1A49F290801D08FBB9301D0603551D0E041604149D144787CA96BA8A3325F84BE499114A798CA3C0300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303234303630333038353334355A810F32303235303130333233353935395A30160603551D20040F300D300B060904007F00070301010130260603551D11041F301D820B6273692E62756E642E6465A40E300C310A300806035504070C014430510603551D12044A30488118637363612D6765726D616E79406273692E62756E642E6465861C68747470733A2F2F7777772E6273692E62756E642E64652F63736361A40E300C310A300806035504070C01443019060767810801010602040E300C02010031071301411302494430350603551D1F042E302C302AA028A0268624687474703A2F2F7777772E6273692E62756E642E64652F746573745F637363615F63726C300A06082A8648CE3D0403040381880030818402402C989BD7DEEF12B7D481C45F8B65AB23B1F68414CC56264B043456BA44B54A8817D64039D0D58AEFB8E9AA2AC0ECF0232754218415CDBC48117F24C5F2C207F702404C63A1A79AEA64FFD7FB825B782166B15E45C59441FF5BB267CEF11075D8B8608570494D3B4057B63C0150FDE4C6BB69213A245D8D588A6F13D546EE6E90882F3182013530820131020101304C3046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E7902020550300D06096086480165030402020500A05A301706092A864886F70D010903310A060804007F0007030201303F06092A864886F70D01090431320430211B2AE69636F9915E7D2BAB325430C94B68ACAC54FA30F17801605B82CE21B4FAF66BBFB51179185C863F5B38E4E860300A06082A8648CE3D0403030467306502302FAABE47685A5863FAC9F105A6A730742A96FF14105C05ED05E36C0C48BC750C9285915B182F7FFB13BD2FA0D2D4BB8F0231008385DA037BEC03E90926121E0DF419A70EA1E821CED1F99456BDEA83A29B1198E79190C3EE7A5842688D644EC00295A9");
		persoDataContainer.setEfChipSecurity("3082078C06092A864886F70D010702A082077D30820779020103310F300D0609608648016503040202050030820188060804007F0007030201A082017A04820176318201723012060A04007F0007020204020202010202010D300D060804007F00070202020201023017060A04007F0007020205020330090201010201010101003019060904007F000702020502300C060704007F0007010202010D3017060A04007F0007020205020330090201010201020101FF3012060A04007F00070202030202020102020129301C060904007F000702020302300C060704007F0007010202010D0201293062060904007F0007020201023052300C060704007F0007010202010D0342000419D4B7447788B0E1993DB35500999627E739A4E5E35F02D8FB07D6122E76567F17758D7A3AA6943EF23E5E2909B3E8B31BFAA4544C2CBF1FB487F31FF239C8F8020129303E060804007F000702020831323012060A04007F0007020203020202010202012D301C060904007F000702020302300C060704007F0007010202010D02012D302A060804007F0007020206161E687474703A2F2F6273692E62756E642E64652F6369662F6E70612E786D6CA082049D30820499308203FEA00302010202020550300A06082A8648CE3D0403043046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E79301E170D3234303630333038353334355A170D3335303130333233353935395A305C310B3009060355040613024445310C300A060355040A0C03425349310D300B06035504051304303133313130302E06035504030C275445535420446F63756D656E74205369676E6572204964656E7469747920446F63756D656E7473308201B53082014D06072A8648CE3D020130820140020101303C06072A8648CE3D01010231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53306404307BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826043004A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C110461041D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C53150231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E904656502010103620004301BB91C96792E65620452749E319C2B62C46B8EBBE846438F098DE4416ECF63463C5518B961482D12FCDFEE2AC349C58B752A893FE94D6E87445976C6309635399E20ED50B5520D501F52835E58AEA0C2A57CC6CFBC7F806228C58F18B0630DA382016630820162301F0603551D23041830168014E4F934EE5ED98D61C3F2EF1A49F290801D08FBB9301D0603551D0E041604149D144787CA96BA8A3325F84BE499114A798CA3C0300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303234303630333038353334355A810F32303235303130333233353935395A30160603551D20040F300D300B060904007F00070301010130260603551D11041F301D820B6273692E62756E642E6465A40E300C310A300806035504070C014430510603551D12044A30488118637363612D6765726D616E79406273692E62756E642E6465861C68747470733A2F2F7777772E6273692E62756E642E64652F63736361A40E300C310A300806035504070C01443019060767810801010602040E300C02010031071301411302494430350603551D1F042E302C302AA028A0268624687474703A2F2F7777772E6273692E62756E642E64652F746573745F637363615F63726C300A06082A8648CE3D0403040381880030818402402C989BD7DEEF12B7D481C45F8B65AB23B1F68414CC56264B043456BA44B54A8817D64039D0D58AEFB8E9AA2AC0ECF0232754218415CDBC48117F24C5F2C207F702404C63A1A79AEA64FFD7FB825B782166B15E45C59441FF5BB267CEF11075D8B8608570494D3B4057B63C0150FDE4C6BB69213A245D8D588A6F13D546EE6E90882F3182013430820130020101304C3046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E7902020550300D06096086480165030402020500A05A301706092A864886F70D010903310A060804007F0007030201303F06092A864886F70D01090431320430CE9B6528803584A477DC4976C0786B3081AFD8D8E3A4E870E5CB7546C8BFB4BEF88CBF8B6EB714AB37986E09D36CD7E8300A06082A8648CE3D0403030466306402301229FEE9CBA478ACE16CA5F8575BAA73C06401F61110C96B12E5E45288D089017612ECAB8C35571C01ACB314C28E69E10230361FC619B8979829AE01D6E45A5A5D983186542719D50634D286EF65CEC9E72198C8A39D0B85A9EA4D62CA518358A661");
		
		String documentNumber = "000000004";
		String sex = "M";
		String mrzLine3 = "COSIC<<<<<<<<<<<<<<<<<<<<<<<<<";
		String mrz = persoDataContainer.createMrzFromDgs(documentNumber, sex, mrzLine3);
		
		persoDataContainer.setMrz(mrz);
		persoDataContainer.setEpassDg1PlainData(mrz);
		
		// unprivileged CA key
		persoDataContainer.addCaKeyPair(CryptoUtil.reconstructKeyPair(13,
				HexString.toByteArray("0419D4B7447788B0E1993DB35500999627E739A4E5E35F02D8FB07D6122E76567F17758D7A3AA6943EF23E5E2909B3E8B31BFAA4544C2CBF1FB487F31FF239C8F8"),
				HexString.toByteArray("A07EB62E891DAA84643E0AFCC1AF006891B669B8F51E379477DBEAB8C987A610")),
				41, false);
		
		// privileged CA key
		persoDataContainer.addCaKeyPair(CryptoUtil.reconstructKeyPair(13,
				HexString.toByteArray("0472E84F60AD1D8F7431DF4F4E49EBCEC897D5FE39381267802A28233F8959F2C1A0459DB30BE8CDC5AB443A61C4FFBC79943C5F0D32ABBFD2E66D756639576060"),
				HexString.toByteArray("7B443FADB6E2A735914EC308979CAF5F0EC3A019615CB12D161DD7816D72D7B0")),
				45, true);

		// individual RI key - 1st sector public/private key pair (Sperrmerkmal)
		KeyPair riKeyPair1 = (KeyPair)PersonalizationFactory.unmarshal(new StringReader("""
				<java.security.KeyPair id="1">
				  <privateKey id="2">
				    <algorithm>ECDH</algorithm>
				    <value>3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104209CAB08A1476FDE746C646B476C2FBFCC286C3B26B2ECE803BD3C4FE0B97FA9B9A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A14403420004474CD3859FC055E17E571D4506FB214F662B45F281CB2015DA1688D579AE501D84A7B7A54B6CAE103290F906E0920ECB7B0C8611431A0866A36E8A3C69CB4A11</value>
				  </privateKey>
				  <publicKey id="3">
				    <algorithm>ECDH</algorithm>
				    <value>308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A702010103420004474CD3859FC055E17E571D4506FB214F662B45F281CB2015DA1688D579AE501D84A7B7A54B6CAE103290F906E0920ECB7B0C8611431A0866A36E8A3C69CB4A11</value>
				  </publicKey>
				</java.security.KeyPair>						
		"""));
		persoDataContainer.addRiKeyPair(riKeyPair1, 1, false);

		// individual RI key - 2nd sector public/private key pair (Pseudonym)
		KeyPair riKeyPair2 = (KeyPair)PersonalizationFactory.unmarshal(new StringReader("""
				<java.security.KeyPair id="1">
				  <privateKey id="2">
				    <algorithm>ECDH</algorithm>
				    <value>3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104206C4C0DE181DDC77F6E21A8319768D91C5F6CA989C8304CBE0EF4ED1B3A38ECBFA081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A1440342000477929C02998A9A272DEFA68F96077E2A06D03B109F800F31E3C85B1AFD07E52E0A312E331CBC46FE7D6425016A8640A076975385C1DE113B505ABC47CA2F63AB</value>
				  </privateKey>
				  <publicKey id="3">
				    <algorithm>ECDH</algorithm>
				    <value>308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A70201010342000477929C02998A9A272DEFA68F96077E2A06D03B109F800F31E3C85B1AFD07E52E0A312E331CBC46FE7D6425016A8640A076975385C1DE113B505ABC47CA2F63AB</value>
				  </publicKey>
				</java.security.KeyPair>						
		"""));
		persoDataContainer.addRiKeyPair(riKeyPair2, 2, true);
	}

}
