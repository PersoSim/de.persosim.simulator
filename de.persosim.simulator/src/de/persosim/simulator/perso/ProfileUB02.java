package de.persosim.simulator.perso;

import java.io.StringReader;
import java.security.KeyPair;

import de.persosim.simulator.crypto.CryptoUtil;
import de.persosim.simulator.utils.HexString;

/**
 * @author amay
 *
 */
public class ProfileUB02 extends AbstractProfile {
	
	@Override
	public void setPersoDataContainer() {
		persoDataContainer = PersonalizationDataContainer.getDefaultContainer();
		persoDataContainer.setDg1PlainData("UB");
//		persoDataContainer.setDg3PlainData("20291031");
		persoDataContainer.setDg3PlainData("20340630");
		persoDataContainer.setDg4PlainData("TOMÁŠ KAREL");
		persoDataContainer.setDg5PlainData("MARTINÍK");
		persoDataContainer.setDg8PlainData("19610817");
		persoDataContainer.setDg9PlainData("MÜNCHEN");
		persoDataContainer.setDg10PlainData("CZE");
		persoDataContainer.setDg13PlainData("VOMÁČKA");
		persoDataContainer.setDg17StreetPlainData("56 CROWN STREET");
		persoDataContainer.setDg17CityPlainData("LONDON");
		persoDataContainer.setDg17CountryPlainData("GBR");
		persoDataContainer.setDg17ZipPlainData("W1H 8BR");
		persoDataContainer.setDg18PlainData("08260000000000");
		persoDataContainer.setEfCardAccess("3181C13012060A04007F0007020204020202010202010D300D060804007F00070202020201023012060A04007F00070202030202020102020129301C060904007F000702020302300C060704007F0007010202010D020129303E060804007F000702020831323012060A04007F0007020203020202010202012D301C060904007F000702020302300C060704007F0007010202010D02012D302A060804007F0007020206161E687474703A2F2F6273692E62756E642E64652F6369662F6E70612E786D6C");
		persoDataContainer.setEfCardSecurity("308209E406092A864886F70D010702A08209D5308209D1020103310F300D06096086480165030402030500308203D8060804007F0007030201A08203CA048203C6318203C23012060A04007F0007020204020202010202010D300D060804007F00070202020201023017060A04007F0007020205020330090201010201010101003019060904007F000702020502300C060704007F0007010202010D3017060A04007F0007020205020330090201010201020101FF3012060A04007F00070202030202020102020129301C060904007F000702020302300C060704007F0007010202010D0201293062060904007F0007020201023052300C060704007F0007010202010D0342000467C26931380033AF00024BA205E8BC592426387A3AB77B38C5996852F3279092570A545BC66A440B2157307CA931CEC064F031AA0D14AC95391ED4B95C5F537E0201293081A3060804007F00070202083181963012060A04007F0007020203020202010202012D301C060904007F000702020302300C060704007F0007010202010D02012D3062060904007F0007020201023052300C060704007F0007010202010D034200046A149CDD36FE247D8AE03AF09A68C9E9D52B7EB70A26B9192044BF2F553E2DB19E5EBE4B7B767D7E5DDFEA5CB84A7256D3B442C104B2256D66253EE8CE4C16F702012D302A060804007F0007020206161E687474703A2F2F6273692E62756E642E64652F6369662F6E70612E786D6C308201E6060804007F0007020207308201D8300B0609608648016503040204308201C73021020101041C8AC93144E93B0B69419544A9893160952DDE1731EA8E669606A18D203021020102041C37823963B71AF0BF5698D1FDC30DA2B7F9ECE57CFA4959BEE9D6D9943021020103041CE8B2A171DC1290A765F124AAFE33061C08C918A1069DFF5CAF4C62B53021020104041C2ABB4A4D769621A05B4966CD5634DBE2E4A53BA54BBD05A8B7E5F6893021020105041CB821E0A865E174C42A9C58DFA3ED1690C1BB85092E8D1D2D45441C1A3021020106041C712B8550E49A13C64DCED4457E9A0F5A85DC26CD6A321596723005D63021020107041C42A8FA36B60887ED022CD3B6ECC255220FBE8CB3F607E416601FCAA63021020108041C8D79C4141E156B5D26916F991E8E3FB1FAF8ACBDE32A80D9CAD71F6A3021020109041CFC20839239B527A0EA6E6AC4F9577D1954A66BD7AAA76F25DDB16962302102010D041C016D5A67F653D44CB346AD28E3829F1ED722CE1146E21D307829E2A23021020111041CEF36BF7FD63D23F779A3531484E4967B490621D555B3020D0C1687C53021020112041CFCB946E587B4A54146D1D2EAFC8F6978021BB0CFB85F719D9E1E533F302102010A041C59F6854DB4F5D4569AF770EA8D25CB1C95BC9F40BE43FD37D2D06256A082049530820491308203F6A003020102020204D6300A06082A8648CE3D0403043046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E79301E170D3230303531383039313634385A170D3330313231383233353935395A3057310B3009060355040613024445310C300A060355040A0C03425349310D300B0603550405130430303031312B302906035504030C225445535420446F63756D656E74205369676E65722065494420446F63756D656E7473308201B53082014D06072A8648CE3D020130820140020101303C06072A8648CE3D01010231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53306404307BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826043004A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C110461041D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C53150231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E9046565020101036200044FE09E288203B2665042982F5E818C0BD239A47F5A6DB2961140AED85AC76CAA90D2BF03E9989F8C10AA85612548B85963F3D568515DB26AD410FAE4F114F9CBC23AA02A781618DE13279DF80F79285A276BEDB75209C0A2A03BA5E14E4FF9B5A38201633082015F301F0603551D23041830168014539DB1872AAC9193D76392EE80D9E5996CF99B3B301D0603551D0E04160414D38EF323DF2F76B21883F81477A45835A9FDC204300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303230303531383039313634385A810F32303230313231383233353935395A30160603551D20040F300D300B060904007F00070301010130260603551D11041F301D820B6273692E62756E642E6465A40E300C310A300806035504070C014430510603551D12044A30488118637363612D6765726D616E79406273692E62756E642E6465861C68747470733A2F2F7777772E6273692E62756E642E64652F63736361A40E300C310A300806035504070C01443016060767810801010602040B300902010031041302554230350603551D1F042E302C302AA028A0268624687474703A2F2F7777772E6273692E62756E642E64652F746573745F637363615F63726C300A06082A8648CE3D04030403818800308184024077DC62E5EBACD558CF27A9D8D2DA93BE46C0E34B55D6069F60E5B864E2459E069FEE1D6C1E65F171E7DEB0E8295CB3D9B1AD6E25015052FE90331BD6E431737F0240390E913A1017B7E5825C03E5D6FA29F2A8B0F74124C166DEA320D957C369FC05E096559C970E75296AD74B1992C2A8DE3E3B4D278A9038FB824BA633BAD076FA3182014430820140020101304C3046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E79020204D6300D06096086480165030402030500A06A301706092A864886F70D010903310A060804007F0007030201304F06092A864886F70D0109043142044031A00249E8BDF2802DC5D892CA198FCA23B0F4B07DC7A90B4B5EED4A6DE030BE53D6BCD4DE7A056729B9EDE85DC464FB7224A67FD098EDF98C071E7BEB0E8A2C300A06082A8648CE3D040304046630640230567668315A6CFF448913C9FF1D77A6FDB10D618EDDBECA08E8054FD456C34CA0967EEF1B7FF16D9100FE4D458A4E625F0230114FBD7595FB84477A3E55F7627D8C5DD4D753DDEAF98651C50A6E2CC5F2A662E4848946FE5C253F79230EAB4F52948F");
		persoDataContainer.setEfChipSecurity("3082079406092A864886F70D010702A082078530820781020103310F300D0609608648016503040203050030820188060804007F0007030201A082017A04820176318201723012060A04007F0007020204020202010202010D300D060804007F00070202020201023017060A04007F0007020205020330090201010201010101003019060904007F000702020502300C060704007F0007010202010D3017060A04007F0007020205020330090201010201020101FF3012060A04007F00070202030202020102020129301C060904007F000702020302300C060704007F0007010202010D0201293062060904007F0007020201023052300C060704007F0007010202010D0342000467C26931380033AF00024BA205E8BC592426387A3AB77B38C5996852F3279092570A545BC66A440B2157307CA931CEC064F031AA0D14AC95391ED4B95C5F537E020129303E060804007F000702020831323012060A04007F0007020203020202010202012D301C060904007F000702020302300C060704007F0007010202010D02012D302A060804007F0007020206161E687474703A2F2F6273692E62756E642E64652F6369662F6E70612E786D6CA082049530820491308203F6A003020102020204D6300A06082A8648CE3D0403043046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E79301E170D3230303531383039313634385A170D3330313231383233353935395A3057310B3009060355040613024445310C300A060355040A0C03425349310D300B0603550405130430303031312B302906035504030C225445535420446F63756D656E74205369676E65722065494420446F63756D656E7473308201B53082014D06072A8648CE3D020130820140020101303C06072A8648CE3D01010231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53306404307BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826043004A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C110461041D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C53150231008CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E9046565020101036200044FE09E288203B2665042982F5E818C0BD239A47F5A6DB2961140AED85AC76CAA90D2BF03E9989F8C10AA85612548B85963F3D568515DB26AD410FAE4F114F9CBC23AA02A781618DE13279DF80F79285A276BEDB75209C0A2A03BA5E14E4FF9B5A38201633082015F301F0603551D23041830168014539DB1872AAC9193D76392EE80D9E5996CF99B3B301D0603551D0E04160414D38EF323DF2F76B21883F81477A45835A9FDC204300E0603551D0F0101FF040403020780302B0603551D1004243022800F32303230303531383039313634385A810F32303230313231383233353935395A30160603551D20040F300D300B060904007F00070301010130260603551D11041F301D820B6273692E62756E642E6465A40E300C310A300806035504070C014430510603551D12044A30488118637363612D6765726D616E79406273692E62756E642E6465861C68747470733A2F2F7777772E6273692E62756E642E64652F63736361A40E300C310A300806035504070C01443016060767810801010602040B300902010031041302554230350603551D1F042E302C302AA028A0268624687474703A2F2F7777772E6273692E62756E642E64652F746573745F637363615F63726C300A06082A8648CE3D04030403818800308184024077DC62E5EBACD558CF27A9D8D2DA93BE46C0E34B55D6069F60E5B864E2459E069FEE1D6C1E65F171E7DEB0E8295CB3D9B1AD6E25015052FE90331BD6E431737F0240390E913A1017B7E5825C03E5D6FA29F2A8B0F74124C166DEA320D957C369FC05E096559C970E75296AD74B1992C2A8DE3E3B4D278A9038FB824BA633BAD076FA3182014430820140020101304C3046310B3009060355040613024445310D300B060355040A0C0462756E64310C300A060355040B0C03627369311A301806035504030C115445535420637363612D6765726D616E79020204D6300D06096086480165030402030500A06A301706092A864886F70D010903310A060804007F0007030201304F06092A864886F70D01090431420440AEEB6102672366A1BDBEF9B2CBAD19CFEA31B5FA763F085F1BE9BCAD88CF184B8B0394CA3A3316760EB6AAE28D60627F543BA7955F64D14A188F41115EE73D16300A06082A8648CE3D04030404663064023030B16EEE8C2BBCFCDEDBE0D9140E3864D0594D6DF279C727C8B31A7DA7F530BBD2A83969FAA70E8B5422C0E81F9BC98202307E2AE08F560D1728483A6463F9E36EFED9F2F213B4C0860071011F2F4D08A2D278CDE14943F7F6E9DE7449DBA17E6216");
		
//		String documentNumber = "00000UB02";
//		String sex = "M";
//		String mrzLine3 = "MARTINIK<<TOMAS<KAREL<<<<<<<<<";
//		String mrz = persoDataContainer.createMrzFromDgs(documentNumber, sex, mrzLine3);
//		
//		persoDataContainer.setMrz(mrz);
//		persoDataContainer.setEpassDg1PlainData(mrz);
		
		// unprivileged CA key
		persoDataContainer.addCaKeyPair(CryptoUtil.reconstructKeyPair(13,
				HexString.toByteArray("0467C26931380033AF00024BA205E8BC592426387A3AB77B38C5996852F3279092570A545BC66A440B2157307CA931CEC064F031AA0D14AC95391ED4B95C5F537E"),
				HexString.toByteArray("751B90F43087F3295E8BD811F8290F2504D06602DA8CD5A2EAAF53FB660C634C")),
				41, false);
		
		// privileged CA key
		persoDataContainer.addCaKeyPair(CryptoUtil.reconstructKeyPair(13,
				HexString.toByteArray("046A149CDD36FE247D8AE03AF09A68C9E9D52B7EB70A26B9192044BF2F553E2DB19E5EBE4B7B767D7E5DDFEA5CB84A7256D3B442C104B2256D66253EE8CE4C16F7"),
				HexString.toByteArray("28AC654F54E503F65A649EB8B343FA97787BD40B0F39119A7D3343DAE553D923")),
				45, true);
		
		// individual RI key - 1st sector public/private key pair (Sperrmerkmal)
		KeyPair riKeyPair1 = (KeyPair)PersonalizationFactory.unmarshal(new StringReader("""
				<java.security.KeyPair id="1">
				  <privateKey id="2">
				    <algorithm>ECDH</algorithm>
				    <value>3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A70201010482015530820151020101042036C8C8C56FEFFFC31ACEF449089174534764F1E813A715EE16CB9C33D8F92D6AA081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A144034200042E431206A002554867EF8A7C17691E6AB5393A09AFB7F4DA1EAEB5267B59323C09F4291C57D5B07A2B2C092B0414F9D27EE6C381B43F18928E704CFD637EBE0E</value>
				  </privateKey>
				  <publicKey id="3">
				    <algorithm>ECDH</algorithm>
				    <value>308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101034200042E431206A002554867EF8A7C17691E6AB5393A09AFB7F4DA1EAEB5267B59323C09F4291C57D5B07A2B2C092B0414F9D27EE6C381B43F18928E704CFD637EBE0E</value>
				  </publicKey>
				</java.security.KeyPair>						
		"""));
		persoDataContainer.addRiKeyPair(riKeyPair1, 1, false);

		// individual RI key - 2nd sector public/private key pair (Pseudonym)
		KeyPair riKeyPair2 = (KeyPair)PersonalizationFactory.unmarshal(new StringReader("""
				<java.security.KeyPair id="1">
				  <privateKey id="2">
				    <algorithm>ECDH</algorithm>
				    <value>3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104202ACCCF1E605D7F6E6106A975F86E23243ECCCF86DA4F1C980C7BF7D5AA130C74A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A144034200047DBD175AC326022032A4ED97CC2A8C1168EC1A34142BF50EEFB408BED20AC34A56B2685A357A8EA0C580E2F816884ADE9AEAF2CA952AF94EB664DA69897FAD30</value>
				  </privateKey>
				  <publicKey id="3">
				    <algorithm>ECDH</algorithm>
				    <value>308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101034200047DBD175AC326022032A4ED97CC2A8C1168EC1A34142BF50EEFB408BED20AC34A56B2685A357A8EA0C580E2F816884ADE9AEAF2CA952AF94EB664DA69897FAD30</value>
				  </publicKey>
				</java.security.KeyPair>						
		"""));
		persoDataContainer.addRiKeyPair(riKeyPair2, 2, true);
	}

}